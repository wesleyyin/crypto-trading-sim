{"ast":null,"code":"var _jsxFileName = \"/Users/work/Documents/GitHub/minimalist_social_media/minesse/src/components/user-profile.component.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class UserProfile extends Component {\n  constructor(props) {\n    super(props);\n    this.updateConnection = this.updateConnection.bind(this);\n    this.renderHead = this.renderHead.bind(this);\n    this.renderContent = this.renderContent.bind(this);\n    this.renderConnectStatus = this.renderConnectStatus.bind(this);\n    this.reqConnect = this.reqConnect.bind(this);\n    this.connect = this.connect.bind(this);\n    this.disconnect = this.disconnect.bind(this);\n    this.updatePosts = this.updatePosts.bind(this);\n    this.editPost = this.editPost.bind(this);\n    this.deletePost = this.deletePost.bind(this);\n    this.nextPost = this.nextPost.bind(this);\n    this.previousPost = this.previousPost.bind(this);\n    this.editProfile = this.editProfile.bind(this);\n    this.state = {\n      userID: '',\n      viewedUser: '',\n      posts: [],\n      connectionStatus: 'none',\n      currPost: 0,\n      connectionID: ''\n    };\n  }\n\n  componentDidMount() {\n    const user = localStorage.getItem(\"username\");\n    alert(user);\n\n    if (user.length == 0) {\n      alert(\"you are not logged in\");\n      window.location.href = '/login';\n    }\n\n    const username = user;\n    const userData = {\n      username: username\n    };\n    console.log(userData);\n    axios.post(\"http://localhost:5000/users/findname\", userData).then(function (res) {\n      if (res.data.status) {\n        let id = res.data.user._id;\n        this.setState({\n          userID: id\n        });\n        const viewedUser = this.props.match.params.username;\n        const viewedUserData = {\n          username: viewedUser\n        };\n        axios.post(\"http://localhost:5000/users/findname\", viewedUserData).then(function (ret) {\n          if (ret.data.status) {\n            this.setState({\n              viewedUser: ret.data.user\n            });\n            this.updateConnection();\n            this.updatePosts();\n          } else {\n            alert('user not found');\n            window.location.href = '/search';\n          }\n        }.bind(this)).catch(err => console.log('Error: ' + err));\n      } else {\n        alert(res.data.msg);\n        window.location.href = '/login';\n      }\n    }.bind(this)).catch(err => console.log('Error: ' + err));\n  }\n\n  nextPost() {\n    if (this.state.currPost < this.state.posts.length) {\n      this.setState({\n        currPost: this.state.currPost + 1\n      });\n    }\n  }\n\n  previousPost() {\n    if (this.state.currPost > 0) {\n      this.setState({\n        currPost: this.state.currPost - 1\n      });\n    }\n  }\n\n  deletePost() {\n    const id = this.state.posts[this.state.currPost]._id;\n    axios.delete(\"http://localhost:5000/posts/\" + id).then(function (res) {\n      alert(res.data);\n      this.updatePosts();\n    }.bind(this)).catch(err => console.log('Error: ' + err));\n  }\n\n  editPost() {\n    const id = this.state.posts[this.state.currPost]._id; //TODO route to edit post page with id as param\n  }\n\n  updatePosts() {\n    const byUser = this.state.viewedUser._id;\n    const byuserData = {\n      user: byUser\n    };\n    axios.post(\"http://localhost:5000/posts/byuser\", byuserData).then(function (res) {\n      this.setState({\n        posts: res.data\n      });\n      console.log(this.state.posts);\n    }.bind(this)).catch(err => console.log('Error: ' + err));\n  }\n\n  updateConnection() {\n    const userA = String(this.state.userID);\n    const userB = String(this.state.viewedUser._id);\n    console.log(userA);\n    console.log(userB);\n    const connectData = {\n      userA: userA,\n      userB: userB\n    };\n    axios.post(\"http://localhost:5000/connections/byusers\", connectData).then(function (res) {\n      const status = res.data.status;\n      alert(status);\n\n      if (this.state.connectionStatus != status) {\n        this.setState({\n          connectionStatus: status\n        });\n\n        if (status != \"not connected\") {\n          this.setState({\n            connectionID: res.data.id\n          });\n        }\n      }\n    }.bind(this)).catch(err => console.log('Error: ' + err));\n  }\n\n  renderHead() {\n    const nameDisplay = this.props.match.params.username;\n    const bio = this.state.viewedUser.bio;\n    const pfp = this.state.viewedUser.profilePic;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: pfp,\n        alt: \"Profile Pic\",\n        id: \"pfp\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        id: \"profName\",\n        children: nameDisplay\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        id: \"bio\",\n        children: bio\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 17\n    }, this);\n  }\n\n  editProfile() {\n    window.location.href = \"/edit-profile\";\n  }\n\n  renderConnectStatus() {\n    const status = this.state.connectionStatus;\n\n    if (status == 'connected') {\n      return /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: this.disconnect,\n        children: \"Disconnect\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 21\n      }, this);\n    } else if (status == 'self') {\n      //display edit head button\n      return /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: this.editProfile,\n        children: \"Edit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 21\n      }, this);\n    } else if (status == 'requested') {\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Requested\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 20\n      }, this);\n    } else if (status == 'pending') {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [this.props.match.params.username, \" wants to connect with you\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: this.connect,\n          children: \"Accept\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: this.disconnect,\n          children: \"Decline\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 13\n      }, this); //display accept/decline buttons\n    } else {\n      //display connect button\n      return /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: this.reqConnect,\n        children: \"Connect\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 21\n      }, this);\n    }\n  }\n\n  disconnect() {\n    axios.delete(\"http://localhost:5000/connections/\" + this.state.connectionID).then(function (res) {\n      alert(res.data);\n      this.updateConnection();\n    }.bind(this)).catch(err => console.log('Error: ' + err));\n  }\n\n  connect() {\n    axios.post(\"http://localhost:5000/connections/accept/\" + this.state.connectionID).then(function (res) {\n      alert(res.data);\n      this.updateConnection();\n    }.bind(this)).catch(err => console.log('Error: ' + err));\n  }\n\n  reqConnect() {\n    const userA = this.state.userID;\n    const userB = this.state.viewedUser._id;\n    const connectData = {\n      userA: userA,\n      userB: userB\n    };\n    axios.post(\"http://localhost:5000/connections/add\", connectData).then(function (res) {\n      alert(res.data);\n      this.updateConnection();\n    }.bind(this)).catch(err => console.log('Error: ' + err));\n  }\n\n  renderContent() {\n    const status = this.state.connectionStatus;\n\n    if (status == 'connected') {\n      //display posts in feed format\n      const currPosts = this.state.posts;\n\n      if (!currPosts.length) {\n        return /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [this.props.match.params.username, \" has no posts\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 24\n        }, this);\n      }\n\n      let posI = this.state.currPost;\n\n      while (posI >= currPosts.length) {\n        posI--;\n      }\n\n      const post = currPosts[posI];\n      const imageName = post.photoName;\n      const caption = post.caption;\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"selfPostDisplay\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: process.env.PUBLIC_URL + '/images_uploads/' + imageName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: caption\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 17\n      }, this);\n    } else if (status == 'self') {\n      const currPosts = this.state.posts;\n\n      if (!currPosts.length) {\n        return /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [this.props.match.params.username, \" has no posts\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 24\n        }, this);\n      }\n\n      let posI = this.state.currPost;\n\n      while (posI >= currPosts.length) {\n        posI--;\n      }\n\n      const post = currPosts[posI];\n      const imageName = post.photoName;\n      const caption = post.caption;\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"selfPostDisplay\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: process.env.PUBLIC_URL + '/images_uploads/' + imageName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: caption\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: this.editPost,\n          children: \"Edit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: this.deletePost,\n          children: \"Delete\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: this.nextPost,\n          children: \"Next\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: this.previousPost,\n          children: \"Previous\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 17\n      }, this);\n    } else {\n      //do not display posts\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Connect with \", this.props.match.params.username, \" to view their posts\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 20\n      }, this);\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(this.renderHead, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(this.renderConnectStatus, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 290,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(this.renderContent, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 9\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/Users/work/Documents/GitHub/minimalist_social_media/minesse/src/components/user-profile.component.js"],"names":["React","Component","axios","Link","UserProfile","constructor","props","updateConnection","bind","renderHead","renderContent","renderConnectStatus","reqConnect","connect","disconnect","updatePosts","editPost","deletePost","nextPost","previousPost","editProfile","state","userID","viewedUser","posts","connectionStatus","currPost","connectionID","componentDidMount","user","localStorage","getItem","alert","length","window","location","href","username","userData","console","log","post","then","res","data","status","id","_id","setState","match","params","viewedUserData","ret","catch","err","msg","delete","byUser","byuserData","userA","String","userB","connectData","nameDisplay","bio","pfp","profilePic","currPosts","posI","imageName","photoName","caption","process","env","PUBLIC_URL","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport {Link} from 'react-router-dom';\n\nexport default class UserProfile extends Component{\n    constructor(props){\n        super(props)\n\n        \n        this.updateConnection = this.updateConnection.bind(this);\n        this.renderHead = this.renderHead.bind(this);\n        this.renderContent = this.renderContent.bind(this);\n        this.renderConnectStatus = this.renderConnectStatus.bind(this);\n\n        this.reqConnect = this.reqConnect.bind(this);\n        this.connect = this.connect.bind(this);\n        this.disconnect = this.disconnect.bind(this);\n\n        this.updatePosts= this.updatePosts.bind(this);\n        this.editPost = this.editPost.bind(this);\n        this.deletePost = this.deletePost.bind(this);\n\n        this.nextPost = this.nextPost.bind(this);\n        this.previousPost = this.previousPost.bind(this);\n\n        this.editProfile = this.editProfile.bind(this);\n\n        this.state = {\n            userID : '',\n            viewedUser: '',\n            posts :[],\n            connectionStatus : 'none',\n            currPost : 0,\n            connectionID : ''\n            \n        };\n\n    }\n    \n    componentDidMount(){\n        const user = localStorage.getItem(\"username\");\n        alert(user);\n        if (user.length ==0) {\n            alert(\"you are not logged in\");\n          window.location.href = '/login';\n        }\n        const username = user;\n        const userData = {\n            username  : username,\n        }\n        console.log(userData);\n        \n        \n        axios.post(\"http://localhost:5000/users/findname\", userData)\n            .then(function(res){\n                \n                if(res.data.status){\n                    let id = res.data.user._id\n                    this.setState({\n                        userID:id\n                    });\n                    const viewedUser = this.props.match.params.username;\n                    const viewedUserData = {\n                        username: viewedUser\n                    };\n                    axios.post(\"http://localhost:5000/users/findname\", viewedUserData)\n                        .then(function(ret){\n                            if(ret.data.status){\n                                this.setState({\n                                    viewedUser: ret.data.user\n                                });this.updateConnection();\n                                this.updatePosts();\n                               \n\n                            }else{\n                                alert('user not found');\n                                window.location.href = '/search';\n                            }\n                        }.bind(this)) \n                        .catch(err => console.log('Error: ' + err));\n                }else{\n                    alert(res.data.msg);\n                    window.location.href = '/login';\n                }\n            }.bind(this))\n            .catch(err => console.log('Error: ' + err));\n    }\n\n    nextPost(){\n        if(this.state.currPost < this.state.posts.length){\n            this.setState({\n                currPost : this.state.currPost + 1\n            })\n        }\n\n    }\n    previousPost(){\n        if(this.state.currPost > 0 ){\n            this.setState({\n                currPost : this.state.currPost - 1\n            })\n        }\n    }\n    deletePost(){\n        const id = this.state.posts[this.state.currPost]._id;\n        axios.delete(\"http://localhost:5000/posts/\" + id)\n        .then(function(res){\n            alert(res.data);\n            this.updatePosts();\n        }.bind(this)) \n        .catch(err => console.log('Error: ' + err));\n    }\n    editPost(){\n        const id = this.state.posts[this.state.currPost]._id;\n        //TODO route to edit post page with id as param\n    }\n    updatePosts(){\n        const byUser = this.state.viewedUser._id;\n        const byuserData = {\n            user: byUser\n        }\n         axios.post(\"http://localhost:5000/posts/byuser\", byuserData)\n             .then(function(res){\n                 this.setState({\n                     posts: res.data\n                 });\n                 console.log(this.state.posts);\n                 \n             }.bind(this)) \n             .catch(err => console.log('Error: ' + err));\n    }\n    updateConnection(){\n        const userA = String(this.state.userID);\n        const userB = String(this.state.viewedUser._id);\n        console.log(userA);\n        console.log(userB);\n        const connectData = {\n            userA : userA,\n            userB: userB\n        };\n        axios.post(\"http://localhost:5000/connections/byusers\", connectData)\n            .then(function(res){\n                const status = res.data.status;\n                alert(status);\n                if(this.state.connectionStatus!=status){\n                    this.setState({\n                        connectionStatus: status\n                    });\n                    if(status!=\"not connected\"){\n                        this.setState({\n                            connectionID : res.data.id\n                        });\n                    }\n                }\n            }.bind(this))\n            .catch(err => console.log('Error: ' + err));\n    }\n    \n    \n    renderHead(){\n        const nameDisplay = this.props.match.params.username;\n        const bio = this.state.viewedUser.bio;\n        const pfp = this.state.viewedUser.profilePic;\n        return (<div>\n            <img src={pfp} alt =\"Profile Pic\" id = \"pfp\"/>\n            <h1 id = \"profName\">{nameDisplay}</h1>\n            <p id = \"bio\">{bio}</p>\n        </div>);\n    }\n    editProfile(){\n\n        window.location.href = \"/edit-profile\";\n\n    }\n    renderConnectStatus(){\n        const status = this.state.connectionStatus;\n        if(status=='connected'){\n            return (<button onClick = {this.disconnect}>Disconnect</button>);\n        }else if(status =='self'){\n            //display edit head button\n            return (<button onClick = {this.editProfile}>Edit</button>);\n        }else if(status =='requested'){\n            return(<p>Requested</p>)\n        }else if(status =='pending'){\n            return (\n            <div>\n                <p>{this.props.match.params.username} wants to connect with you</p>\n                <button onClick = {this.connect}>Accept</button>\n                <button onClick = {this.disconnect}>Decline</button>\n            </div>\n            \n                )\n            //display accept/decline buttons\n        }else{\n            //display connect button\n            return (<button onClick = {this.reqConnect}>Connect</button>);\n        }\n    }\n    disconnect(){\n        \n        axios.delete(\"http://localhost:5000/connections/\" + this.state.connectionID)\n        .then(function(res){\n            alert(res.data);\n            this.updateConnection();\n        }.bind(this))\n        .catch(err => console.log('Error: ' + err));\n    }\n    connect(){\n        axios.post(\"http://localhost:5000/connections/accept/\" + this.state.connectionID)\n        .then(function(res){\n            alert(res.data);\n            this.updateConnection();\n        }.bind(this))\n        .catch(err => console.log('Error: ' + err));\n    }\n    reqConnect(){\n        const userA = this.state.userID;\n        const userB = this.state.viewedUser._id;\n        const connectData = {\n            userA: userA,\n            userB: userB,\n        };\n        axios.post(\"http://localhost:5000/connections/add\", connectData)\n            .then(function(res){\n                alert(res.data);\n                this.updateConnection();\n            }.bind(this))\n            .catch(err => console.log('Error: ' + err));\n    }\n    renderContent(){\n        const status = this.state.connectionStatus;\n\n        if(status=='connected'){\n            //display posts in feed format\n            const currPosts = this.state.posts;\n            if(!currPosts.length){\n                return(<p>{this.props.match.params.username} has no posts</p>);\n            }\n            \n            let posI = this.state.currPost\n            while(posI>= currPosts.length){\n                posI--;\n            }\n            const post = currPosts[posI];\n            const imageName = post.photoName;\n            const caption = post.caption;\n            return (\n                <div id = \"selfPostDisplay\">\n                    <img src={process.env.PUBLIC_URL + '/images_uploads/' + imageName} />\n                    <p>{caption}</p>\n                    \n                </div>\n                \n                );\n            \n        }else if(status =='self'){\n            const currPosts = this.state.posts;\n            if(!currPosts.length){\n                return(<p>{this.props.match.params.username} has no posts</p>);\n            }\n            \n            let posI = this.state.currPost\n            while(posI>= currPosts.length){\n                posI--;\n            }\n            const post = currPosts[posI];\n            const imageName = post.photoName;\n            const caption = post.caption;\n            return (\n                <div id = \"selfPostDisplay\">\n                    <img src={process.env.PUBLIC_URL + '/images_uploads/' + imageName} />\n                    <p>{caption}</p>\n                    <button onClick = {this.editPost}>Edit</button>\n                    <button onClick = {this.deletePost}>Delete</button>\n                    <button onClick = {this.nextPost}>Next</button>\n                    <button onClick = {this.previousPost}>Previous</button>\n                </div>\n                \n                );\n        }else{\n            //do not display posts\n            return(<p>Connect with {this.props.match.params.username} to view their posts</p>);\n        }\n    }\n\n    render(){\n        return (\n        <div>\n            <this.renderHead/>\n            <this.renderConnectStatus/>\n            <this.renderContent/>\n        </div>\n\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}